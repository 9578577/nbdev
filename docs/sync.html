---

title: Updating modules to notebooks
keywords: fastai
sidebar: home_sidebar

summary: "The functions that propagates small changes in the library back to notebooks"
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_sync.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The library is primarily developed in notebooks so any big changes should be made there. But sometimes, it's easier to fix small bugs or typos in the modules directly. <a href="/sync.html#script2notebook"><code>script2notebook</code></a> is the function that will propagate those changes back to the corresponding notebooks. Note that you can't create new cells with that functionality, so your corrections should remain limited.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finding-the-way-back-to-notebooks">Finding the way back to notebooks<a class="anchor-link" href="#Finding-the-way-back-to-notebooks">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to get the name of the object we are looking for, and then we'll try to find it in our index file.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_name" class="doc_header"><code>get_name</code><a href="https://github.com/fastai/nbdev/tree/master/nbdev/sync.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_name</code>(<strong><code>obj</code></strong>)</p>
</blockquote>
<p>Get the name of <code>obj</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="k">import</span> <span class="n">DocsTestClass</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">get_name</span><span class="p">(</span><span class="n">in_ipython</span><span class="p">),</span> <span class="s1">&#39;in_ipython&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">get_name</span><span class="p">(</span><span class="n">DocsTestClass</span><span class="o">.</span><span class="n">test</span><span class="p">),</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qual_name" class="doc_header"><code>qual_name</code><a href="https://github.com/fastai/nbdev/tree/master/nbdev/sync.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qual_name</code>(<strong><code>obj</code></strong>)</p>
</blockquote>
<p>Get the qualified name of <code>obj</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Qualified name is different from name in python for methos and properties:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">qual_name</span><span class="p">(</span><span class="n">DocsTestClass</span><span class="o">.</span><span class="n">test</span><span class="p">),</span> <span class="s1">&#39;DocsTestClass.test&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="source_nb" class="doc_header"><code>source_nb</code><a href="https://github.com/fastai/nbdev/tree/master/nbdev/sync.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>source_nb</code>(<strong><code>func</code></strong>, <strong><code>is_name</code></strong>=<em><code>None</code></em>, <strong><code>return_all</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Return the name of the notebook where <code>func</code> was defined</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For properties defined using <code>property</code> or our own <code>add_props</code> helper, we approximate the name by looking at their getter functions, since we don't seem to have access to the property name itself. If everything fails (a getter cannot be found), we return the name of the object that contains the property. This suffices for <a href="/sync.html#source_nb"><code>source_nb</code></a> to work.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can either pass an object or its name (by default <code>is_name</code> will look if <code>func</code> is a string or not to determine if it should be <code>True</code> or <code>False</code>, but you can override if there is some inconsistent behavior).</p>
<p>If passed a method of a class, the function will return the notebook in which the largest part of the function name was defined in case there is a monkey-matching that defines <code>class.method</code> in a different notebook than <code>class</code>. If <code>return_all=True</code>, the function will return a tuple with the name by which the function was found and the notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">source_nb</span><span class="p">(</span><span class="n">notebook2script</span><span class="p">),</span> <span class="s1">&#39;00_export.ipynb&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">source_nb</span><span class="p">(</span><span class="n">DocsTestClass</span><span class="p">),</span> <span class="s1">&#39;00_export.ipynb&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">source_nb</span><span class="p">(</span><span class="n">DocsTestClass</span><span class="o">.</span><span class="n">test</span><span class="p">),</span> <span class="s1">&#39;00_export.ipynb&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-17-524e8ceb0180&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> test_eq<span class="ansi-blue-fg">(</span>source_nb<span class="ansi-blue-fg">(</span>notebook2script<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;00_export.ipynb&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>test_eq<span class="ansi-blue-fg">(</span>source_nb<span class="ansi-blue-fg">(</span>_DocsTestClass<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;00_export.ipynb&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> test_eq<span class="ansi-blue-fg">(</span>source_nb<span class="ansi-blue-fg">(</span>_DocsTestClass<span class="ansi-blue-fg">.</span>test<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;00_export.ipynb&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-green-fg">assert</span> source_nb<span class="ansi-blue-fg">(</span>int<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span>

<span class="ansi-green-fg">~/git/nbdev/nbs/nbdev/imports.py</span> in <span class="ansi-cyan-fg">test_eq</span><span class="ansi-blue-fg">(a, b)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> <span class="ansi-green-fg">from</span> functools <span class="ansi-green-fg">import</span> partial
<span class="ansi-green-intense-fg ansi-bold">     10</span> 
<span class="ansi-green-fg">---&gt; 11</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">def</span> test_eq<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">assert</span> a<span class="ansi-blue-fg">==</span>b<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">f&#39;{a}, {b}&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span> 
<span class="ansi-green-intense-fg ansi-bold">     13</span> <span class="ansi-green-fg">def</span> save_config_file<span class="ansi-blue-fg">(</span>file<span class="ansi-blue-fg">,</span> d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">AssertionError</span>: None, 00_export.ipynb</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reading-the-library">Reading the library<a class="anchor-link" href="#Reading-the-library">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If someone decides to change a module instead of the notebooks, the following functions help update the notebooks accordingly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">_relimport2name</span><span class="p">(</span><span class="s1">&#39;.core&#39;</span><span class="p">,</span> <span class="s1">&#39;nbdev/data.py&#39;</span><span class="p">),</span> <span class="s1">&#39;nbdev.core&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_relimport2name</span><span class="p">(</span><span class="s1">&#39;.core&#39;</span><span class="p">,</span> <span class="s1">&#39;home/sgugger/fastai_dev/nbdev/nbdev/data.py&#39;</span><span class="p">),</span> <span class="s1">&#39;nbdev.core&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_relimport2name</span><span class="p">(</span><span class="s1">&#39;..core&#39;</span><span class="p">,</span> <span class="s1">&#39;nbdev/vision/data.py&#39;</span><span class="p">),</span> <span class="s1">&#39;nbdev.core&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_relimport2name</span><span class="p">(</span><span class="s1">&#39;.transform&#39;</span><span class="p">,</span> <span class="s1">&#39;nbdev/vision/data.py&#39;</span><span class="p">),</span> <span class="s1">&#39;nbdev.vision.transform&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_relimport2name</span><span class="p">(</span><span class="s1">&#39;..notebook.core&#39;</span><span class="p">,</span> <span class="s1">&#39;nbdev/data/external.py&#39;</span><span class="p">),</span> <span class="s1">&#39;nbdev.notebook.core&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dic</span> <span class="o">=</span> <span class="n">notebook2script</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">to_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_script2notebook</span><span class="p">(</span><span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">lib_path</span><span class="o">/</span><span class="s1">&#39;export.py&#39;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted export.py.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="script2notebook" class="doc_header"><code>script2notebook</code><a href="https://github.com/fastai/nbdev/tree/master/nbdev/sync.py#L108" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>script2notebook</code>(<strong><code>fname</code></strong>=<em><code>None</code></em>, <strong><code>silent</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">script2notebook</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted showdoc.py.
Converted test.py.
Converted sync.py.
Converted export.py.
Converted export2html.py.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Diff-notebook---library">Diff notebook - library<a class="anchor-link" href="#Diff-notebook---library">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="diff_nb_script" class="doc_header"><code>diff_nb_script</code><a href="https://github.com/fastai/nbdev/tree/master/nbdev/sync.py#L123" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>diff_nb_script</code>()</p>
</blockquote>
<p>Print the diff between the notebooks and the library in <code>lib_folder</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diff_nb_script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export">&#182;</a></h2>
</div>
</div>
</div>
</div>
 

